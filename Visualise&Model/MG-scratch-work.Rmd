---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---
 

```{r}

knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(jsonlite)
library(httr)
library(rvest)
library(readxl)
library(tidyverse)
library(mdsr)   
library(tidyr)
library(ggplot2)
library(readr)
library(knitr)

df <- final_df %>% 
  filter(pop_estimate_msa > 5000000)


ggplot(df, aes(y= passenger_trips/1000000, x= year, color = transit_modes)) + geom_point() + geom_smooth() + labs(y="Trips (in Millons)")

ggplot(final_df, aes(y= percent_workers_commuting_by_public_transit_msa, x= passenger_trips)) + geom_point() 


#Total Trips Over Time
final_df %>% 
  group_by(year, transit_modes) %>% 
  summarise(sum_trips = sum(passenger_trips)) %>% 
  ggplot( aes(x = year, y = sum_trips/1000000000, color = transit_modes)) +geom_point() + labs(x= "Year", y= "Total Trips (in Billions)")

#gdp and percent workers commuting
df <- final_df %>% 
  filter(transit_modes == "Rail") %>% 
  mutate(log10_gdp= log10(gdp_msa))  %>% 
  mutate(log10_commuting = log10(percent_workers_commuting_by_public_transit_msa))

  ggplot(df, aes(x =log10_gdp, y = log10_commuting)) +geom_point(alpha= .8) + labs(x= "GDP by City (Log 10)", y = "Percent Workers Commuting via Public Transit") + geom_smooth(method = 'lm')

#percent commuting and trips
df <- final_df %>% 
  mutate(log10_trips= log10(passenger_trips))  %>% 
  mutate(log10_commuting = log10(percent_workers_commuting_by_public_transit_msa))

ggplot(df, aes(y = log10_commuting, x = log10_trips)) + geom_point(alpha= .2)+ labs(y= "log10(Percent Commuting)", x = "log10(Trips)") + geom_smooth(method = 'lm') + facet_grid(.~transit_modes)

ggplot(df, aes(x = log10_commuting, y = log10_trips)) + geom_point(alpha= .2)+ labs(x= "log10(Percent Commuting)", y = "log10(Trips)") + geom_smooth(method = 'lm') + facet_grid(.~transit_modes)
  

#percent commuting and miles
df <- final_df %>% 
  mutate(log10_miles= log10(vehicle_miles))  %>% 
  mutate(log10_commuting = log10(percent_workers_commuting_by_public_transit_msa))

ggplot(df, aes(x = log10_commuting, y = log10_miles)) + geom_jitter(alpha= .2)+ labs(x= "log10(Percent Commuting)", y = "log10(Vehicle Miles)") + geom_smooth(method = 'lm') 

#trips and gdp

df <- final_df %>% 
  mutate(log10_trips= log10(passenger_trips))  %>% 
  mutate(log10_gdp = log10(gdp_msa)) 

ggplot(df, aes(x = log10_trips, y = log10_gdp, color= as.character(year))) + geom_jitter(alpha= .2)+ labs(x= "log10(Passenger Trips)", y = "log10(GDP)") + geom_smooth(method = 'lm') 
  
```


